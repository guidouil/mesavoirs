<template name='scanned'>
  <div class="ui main container">
    {{#if equals scanType 'userId'}}
    {{#if myPlaces}}
      {{#if isSellerOrOwnerRole}}
        {{#if place.loyaltyCard.enabled}}
          <h4>Carte de fidélité{{#if customerEmail}} de {{customerEmail}}{{/if}}</h4>
          <div class="fluid ui left labeled center aligned big button" tabindex="2">
            <a class="ui basic label" data-action="loyaltyCardHistory">
              <i class="yellow star icon"></i> {{userPoints}} / {{place.loyaltyCard.size}} points
            </a>
            <div class="ui olive button" id="addOnePoint">
               +1 point
            </div>
          </div>
          {{#if loyaltyCardDate}}
          <span data-action="loyaltyCardHistory">
            <i class="history icon"></i> Mise à jour {{fromNow loyaltyCardDate}}<br>
          </span>
          {{/if}}
          <p>
            Chaque tranche d'achat de {{formatMoney place.loyaltyCard.pointCost}} ajoute 1 point à la carte de fidélité.<br>
            Quand la carte atteint {{place.loyaltyCard.size}} points, votre client reçoit automatiquement un avoir de {{formatMoney place.loyaltyCard.voucherValue}} et le compte de points est remis a zéro.
          </p>
        {{/if}}
        <h4>Avoir{{#if customerEmail}} de {{customerEmail}}{{/if}}</h4>
          <div class="ui horizontal list">
          {{#each vouchers}}
            <div class="item" id="useVoucher" data-action="voucherHistory">
              <i class="large blue ticket icon"></i>
              <div class="content">
                <div class="header">{{formatMoney value}}</div>
                {{#if histories}}
                <div class="extra">
                  <i class="grey history icon"></i>Mis à jour {{#if updatedAt}}{{fromNow updatedAt}}{{else}}{{fromNow createdAt}}{{/if}}
                </div>
                {{/if}}
              </div>
            </div>
          {{/each}}
          </div>
          <div class="ui fluid left icon action input">
            <i class="euro icon"></i>
            <input type="number" step="any" placeholder="Montant" tabindex="1" id="voucherValue" size="3" value="{{voucherValue}}">
            <button class="ui green button" id="giveVoucher">
              Donner
            </button>
            <button class="ui red button" id="takeVoucher">
              Prendre
            </button>
          </div>
          {{> histories}}
      {{/if}}
    {{else}}
    <div class="ui basic center aligned segment">
      <h2 class="ui icon header">
        <i class="green add user icon"></i>
        <div class="content">
          Vous avez scanné quelqu'un
          <div class="sub header">Mais vous n'avez pas enregistré votre commerce</div>
        </div>
      </h2>
      <p>
        <a class="ui button" href="{{pathFor 'createPlace'}}">Inscrivez votre commerce</a>
      </p>
      {{> loginText}}
    </div>
    {{/if}}
    {{else}}
    <div class="ui basic center aligned segment">
      <h2 class="ui icon header">
        <i class="green barcode icon"></i>
        <div class="content">
          Vous avez scanné un code au format {{scanType}}
          <div class="sub header">Sa valeur est {{scanId}}</div>
        </div>
      </h2>
      <p>
        C'est une de vos cartes de fidélité à enregistrer ?
        <button id="addThisCard" class="ui positive button">Ajouter cette carte</button>
      </p>
      {{> loginText}}
    </div>
    {{/if}}
  </div>
</template>
